<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<head>
</head>

<body>
  <script type="text/javascript" src="ZiliqaJS.browser.js"></script>
  <script type="text/javascript" src="bn.js"></script>
  <script type="text/javascript" src="long.js"></script>
  <script type="text/javascript">
    const { Zilliqa } = window.ZilliqaJS
    const zjs = new Zilliqa('https://api.zilliqa.com')

    //private key is for address: 0x573EC96638C8BB1C386394602E1460634F02ADDD
    //sendTransaction('f03ececc92a157aa4c3f26de32069749f7325bac', '15000', '100', 'f03ececc92a157aa4c3f26de32069749f7325bac');

    function sendTransaction(toaddress, amount, gasPrice, senderPrivateKey) {

      zjs.wallet.addByPrivateKey(
        senderPrivateKey,
      );
      console.log("Preparing to send the transaction...");

      sendTx(toaddress, parseFloat(amount), gasPrice).then(function (output) {
        console.log(">> output status " + output.status);
        console.log(">> transaction id " + output.id);
        Android.showHash(output.id);
      });
    }

    async function sendTx(toaddress, amount, gPrice) {
      try {
        // Send a transaction to the network
        console.log(">> to : " + toaddress + " > amount > " + amount);
        const tx = await zjs.blockchain.createTransaction(
          zjs.transactions.new({
            version: 1,
            toAddr: toaddress,
            amount: new BN(amount),
            gasPrice: new BN(gPrice),
            gasLimit: Long.fromNumber(10),
          }),
        );
        return tx;
      } catch (err) {
        Android.showError(err.message)
        console.log(err);
      }
    }
  </script>
</body>

</html>
